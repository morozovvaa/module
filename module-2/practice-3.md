# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ 3: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤

**–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 4 –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö —á–∞—Å–∞  
**–ú–æ–¥—É–ª—å:** –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ

---

## –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–ü—Ä–æ–≤–µ—Å—Ç–∏ –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏–ª–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –≤—ã—è–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ç–µ–º—ã, –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è —Å –Ω–∏–∑–∫–æ–π —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å—é –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –¥–ª—è —É—á–∏—Ç–µ–ª—è.

---

## –ó–∞–¥–∞–Ω–∏–µ

–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è:

1. **–ó–∞–≥—Ä—É–∂–∞–µ—Ç** –¥–∞–Ω–Ω—ã–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö —Ç–µ—Å—Ç–∞ (–∑–∞–¥–∞–Ω–∏—è –∏ –æ—Ç–≤–µ—Ç—ã —É—á–µ–Ω–∏–∫–æ–≤)
2. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç** —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å –ø–æ –∫–∞–∂–¥–æ–º—É –∑–∞–¥–∞–Ω–∏—é
3. **–í—ã—è–≤–ª—è–µ—Ç** –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ç–µ–º—ã (–ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ < 60%)
4. **–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç** —É—á–µ–Ω–∏–∫–æ–≤, –Ω—É–∂–¥–∞—é—â–∏—Ö—Å—è –≤ –ø–æ–º–æ—â–∏
5. **–í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç** —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ –∑–∞–¥–∞–Ω–∏—è–º, —É—á–µ–Ω–∏–∫–∞–º, —Ç–µ–º–∞–º)
6. **–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç** –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
7. **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç** –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Excel –∏ PDF

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–§–∞–π–ª `test_results.csv`:
```csv
–£—á–µ–Ω–∏–∫,–ó–∞–¥–∞–Ω–∏–µ_1,–ó–∞–¥–∞–Ω–∏–µ_2,–ó–∞–¥–∞–Ω–∏–µ_3,–ó–∞–¥–∞–Ω–∏–µ_4,–ó–∞–¥–∞–Ω–∏–µ_5,–ó–∞–¥–∞–Ω–∏–µ_6,–ó–∞–¥–∞–Ω–∏–µ_7,–ó–∞–¥–∞–Ω–∏–µ_8,–ó–∞–¥–∞–Ω–∏–µ_9,–ó–∞–¥–∞–Ω–∏–µ_10
–ò–≤–∞–Ω–æ–≤ –ò.–ò.,1,1,0,1,1,1,0,1,1,1
–ü–µ—Ç—Ä–æ–≤–∞ –ú.–ê.,1,1,1,1,0,1,1,1,1,0
...
```

–§–∞–π–ª `test_info.csv` (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞–Ω–∏—è—Ö):
```csv
–ó–∞–¥–∞–Ω–∏–µ,–¢–µ–º–∞,–ú–∞–∫—Å_–±–∞–ª–ª,–°–ª–æ–∂–Ω–æ—Å—Ç—å
–ó–∞–¥–∞–Ω–∏–µ_1,–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è,1,–õ–µ–≥–∫–æ
–ó–∞–¥–∞–Ω–∏–µ_2,–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è,1,–°—Ä–µ–¥–Ω–µ
...
```

---

## –ü–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from datetime import datetime

# ============================================
# –ì–ï–ù–ï–†–ê–¶–ò–Ø –¢–ï–°–¢–û–í–´–• –î–ê–ù–ù–´–•
# ============================================

def generate_test_data():
    """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏"""
    
    np.random.seed(42)
    students = [f'–£—á–µ–Ω–∏–∫_{i}' for i in range(1, 26)]
    n_questions = 15
    
    # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ (0 –∏–ª–∏ 1)
    results_data = {'–£—á–µ–Ω–∏–∫': students}
    for i in range(1, n_questions + 1):
        # –†–∞–∑–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: –ø–µ—Ä–≤—ã–µ 5 - –ª–µ–≥–∫–∏–µ, —Å—Ä–µ–¥–Ω–∏–µ 5 - —Å—Ä–µ–¥–Ω–∏–µ, –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 - —Å–ª–æ–∂–Ω—ã–µ
        if i <= 5:
            prob = 0.85  # 85% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
        elif i <= 10:
            prob = 0.65  # 65% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
        else:
            prob = 0.45  # 45% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
        
        results_data[f'–ó–∞–¥–∞–Ω–∏–µ_{i}'] = np.random.choice([0, 1], size=len(students), p=[1-prob, prob])
    
    results_df = pd.DataFrame(results_data)
    
    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞–Ω–∏—è—Ö
    topics = ['–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è'] * 3 + ['–¢–µ–æ—Ä–µ–º–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞'] * 3 + \
             ['–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è'] * 3 + ['–õ–æ–≥–∞—Ä–∏—Ñ–º—ã'] * 3 + ['–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è'] * 3
    
    difficulty = ['–õ–µ–≥–∫–æ'] * 5 + ['–°—Ä–µ–¥–Ω–µ'] * 5 + ['–°–ª–æ–∂–Ω–æ'] * 5
    
    test_info_df = pd.DataFrame({
        '–ó–∞–¥–∞–Ω–∏–µ': [f'–ó–∞–¥–∞–Ω–∏–µ_{i}' for i in range(1, n_questions + 1)],
        '–¢–µ–º–∞': topics,
        '–ú–∞–∫—Å_–±–∞–ª–ª': [1] * n_questions,
        '–°–ª–æ–∂–Ω–æ—Å—Ç—å': difficulty
    })
    
    return results_df, test_info_df

# ============================================
# –ê–ù–ê–õ–ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í
# ============================================

def analyze_test_results(results_df, test_info_df):
    """–ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"""
    
    question_cols = [col for col in results_df.columns if col.startswith('–ó–∞–¥–∞–Ω–∏–µ_')]
    
    # –û–±—â–∏–µ –±–∞–ª–ª—ã —É—á–µ–Ω–∏–∫–æ–≤
    results_df['–û–±—â–∏–π_–±–∞–ª–ª'] = results_df[question_cols].sum(axis=1)
    results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'] = (results_df['–û–±—â–∏–π_–±–∞–ª–ª'] / len(question_cols) * 100).round(1)
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –∑–∞–¥–∞–Ω–∏—é
    question_stats = []
    for question in question_cols:
        correct_count = results_df[question].sum()
        total_count = len(results_df)
        percent_correct = (correct_count / total_count * 100)
        
        question_stats.append({
            '–ó–∞–¥–∞–Ω–∏–µ': question,
            '–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö_–æ—Ç–≤–µ—Ç–æ–≤': correct_count,
            '–í—Å–µ–≥–æ_—É—á–µ–Ω–∏–∫–æ–≤': total_count,
            '–ü—Ä–æ—Ü–µ–Ω—Ç_–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö': percent_correct
        })
    
    question_stats_df = pd.DataFrame(question_stats)
    
    # –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∑–∞–¥–∞–Ω–∏—è—Ö
    question_stats_df = question_stats_df.merge(test_info_df, on='–ó–∞–¥–∞–Ω–∏–µ')
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–µ–º–∞–º
    topic_stats = question_stats_df.groupby('–¢–µ–º–∞').agg({
        '–ü—Ä–æ—Ü–µ–Ω—Ç_–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö': 'mean'
    }).reset_index()
    topic_stats.columns = ['–¢–µ–º–∞', '–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Ü–µ–Ω—Ç']
    topic_stats = topic_stats.sort_values('–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Ü–µ–Ω—Ç')
    
    return results_df, question_stats_df, topic_stats

# ============================================
# –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø
# ============================================

def create_analysis_dashboard(results_df, question_stats_df, topic_stats):
    """–°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞ —Å –∞–Ω–∞–ª–∏–∑–æ–º"""
    
    fig = plt.figure(figsize=(18, 12))
    fig.suptitle('–ê–ù–ê–õ–ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –ö–û–ù–¢–†–û–õ–¨–ù–û–ô –†–ê–ë–û–¢–´', 
                 fontsize=20, fontweight='bold', y=0.98)
    
    # 1. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤ —É—á–µ–Ω–∏–∫–æ–≤
    ax1 = plt.subplot(3, 3, 1)
    ax1.hist(results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'], bins=10, color='skyblue', edgecolor='black', alpha=0.7)
    ax1.axvline(results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'].mean(), color='red', linestyle='--', 
                linewidth=2, label=f'–°—Ä–µ–¥–Ω–µ–µ: {results_df["–ü—Ä–æ—Ü–µ–Ω—Ç"].mean():.1f}%')
    ax1.set_xlabel('–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤', fontweight='bold')
    ax1.set_ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–Ω–∏–∫–æ–≤', fontweight='bold')
    ax1.set_title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤', fontsize=12, fontweight='bold')
    ax1.legend()
    ax1.grid(axis='y', alpha=0.3)
    
    # 2. –£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å –ø–æ –∑–∞–¥–∞–Ω–∏—è–º
    ax2 = plt.subplot(3, 3, (2, 3))
    colors = ['green' if x >= 70 else 'orange' if x >= 50 else 'red' 
              for x in question_stats_df['–ü—Ä–æ—Ü–µ–Ω—Ç_–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö']]
    bars = ax2.barh(question_stats_df['–ó–∞–¥–∞–Ω–∏–µ'], 
                    question_stats_df['–ü—Ä–æ—Ü–µ–Ω—Ç_–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö'], color=colors, alpha=0.7)
    ax2.axvline(x=60, color='black', linestyle='--', linewidth=2, label='–ü–æ—Ä–æ–≥ (60%)')
    ax2.set_xlabel('–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤', fontweight='bold')
    ax2.set_title('–£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å –ø–æ –∑–∞–¥–∞–Ω–∏—è–º', fontsize=12, fontweight='bold')
    ax2.legend()
    ax2.grid(axis='x', alpha=0.3)
    for i, (bar, value) in enumerate(zip(bars, question_stats_df['–ü—Ä–æ—Ü–µ–Ω—Ç_–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö'])):
        ax2.text(value + 1, bar.get_y() + bar.get_height()/2, 
                f'{value:.0f}%', va='center', fontsize=8, fontweight='bold')
    
    # 3. –£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å –ø–æ —Ç–µ–º–∞–º
    ax3 = plt.subplot(3, 3, 4)
    colors_topics = ['red' if x < 60 else 'orange' if x < 70 else 'green' 
                     for x in topic_stats['–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Ü–µ–Ω—Ç']]
    bars = ax3.barh(topic_stats['–¢–µ–º–∞'], topic_stats['–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Ü–µ–Ω—Ç'], 
                    color=colors_topics, alpha=0.7, edgecolor='black')
    ax3.axvline(x=60, color='black', linestyle='--', linewidth=2)
    ax3.set_xlabel('–°—Ä–µ–¥–Ω–∏–π % –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö', fontweight='bold')
    ax3.set_title('–£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å –ø–æ —Ç–µ–º–∞–º', fontsize=12, fontweight='bold')
    ax3.grid(axis='x', alpha=0.3)
    for bar, value in zip(bars, topic_stats['–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Ü–µ–Ω—Ç']):
        ax3.text(value + 1, bar.get_y() + bar.get_height()/2, 
                f'{value:.0f}%', va='center', fontweight='bold')
    
    # 4. –¢–æ–ø –∏ –∞—É—Ç—Å–∞–π–¥–µ—Ä—ã
    ax4 = plt.subplot(3, 3, 5)
    top5 = results_df.nlargest(5, '–ü—Ä–æ—Ü–µ–Ω—Ç')[['–£—á–µ–Ω–∏–∫', '–ü—Ä–æ—Ü–µ–Ω—Ç']]
    bottom5 = results_df.nsmallest(5, '–ü—Ä–æ—Ü–µ–Ω—Ç')[['–£—á–µ–Ω–∏–∫', '–ü—Ä–æ—Ü–µ–Ω—Ç']]
    
    combined = pd.concat([top5, bottom5])
    colors_students = ['green'] * 5 + ['red'] * 5
    
    ax4.barh(range(len(combined)), combined['–ü—Ä–æ—Ü–µ–Ω—Ç'].values, 
             color=colors_students, alpha=0.7, edgecolor='black')
    ax4.set_yticks(range(len(combined)))
    ax4.set_yticklabels(combined['–£—á–µ–Ω–∏–∫'].values, fontsize=8)
    ax4.set_xlabel('–ü—Ä–æ—Ü–µ–Ω—Ç', fontweight='bold')
    ax4.set_title('–¢–æ–ø-5 –∏ –ê—É—Ç—Å–∞–π–¥–µ—Ä—ã', fontsize=12, fontweight='bold')
    ax4.invert_yaxis()
    ax4.grid(axis='x', alpha=0.3)
    ax4.axhline(y=4.5, color='black', linestyle='-', linewidth=2)
    
    # 5. Box plot –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
    ax5 = plt.subplot(3, 3, 6)
    difficulty_data = []
    for _, row in question_stats_df.iterrows():
        difficulty_data.append({
            '–°–ª–æ–∂–Ω–æ—Å—Ç—å': row['–°–ª–æ–∂–Ω–æ—Å—Ç—å'],
            '–ü—Ä–æ—Ü–µ–Ω—Ç': row['–ü—Ä–æ—Ü–µ–Ω—Ç_–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö']
        })
    difficulty_df = pd.DataFrame(difficulty_data)
    
    sns.boxplot(x='–°–ª–æ–∂–Ω–æ—Å—Ç—å', y='–ü—Ä–æ—Ü–µ–Ω—Ç', data=difficulty_df, 
                palette='Set2', ax=ax5, order=['–õ–µ–≥–∫–æ', '–°—Ä–µ–¥–Ω–µ', '–°–ª–æ–∂–Ω–æ'])
    ax5.set_ylabel('–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö', fontweight='bold')
    ax5.set_xlabel('–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏', fontweight='bold')
    ax5.set_title('–£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å –ø–æ —É—Ä–æ–≤–Ω—è–º', fontsize=12, fontweight='bold')
    ax5.grid(axis='y', alpha=0.3)
    
    # 6. –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    ax6 = plt.subplot(3, 3, (7, 9))
    question_cols = [col for col in results_df.columns if col.startswith('–ó–∞–¥–∞–Ω–∏–µ_')]
    heatmap_data = results_df.set_index('–£—á–µ–Ω–∏–∫')[question_cols]
    
    sns.heatmap(heatmap_data, annot=False, cmap='RdYlGn', vmin=0, vmax=1,
                cbar_kws={'label': '–ü—Ä–∞–≤–∏–ª—å–Ω–æ/–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ'},
                linewidths=0.5, linecolor='gray', ax=ax6)
    ax6.set_title('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö —É—á–µ–Ω–∏–∫–æ–≤ –ø–æ –∑–∞–¥–∞–Ω–∏—è–º', fontsize=12, fontweight='bold')
    ax6.set_xlabel('–ó–∞–¥–∞–Ω–∏–µ', fontweight='bold')
    ax6.set_ylabel('–£—á–µ–Ω–∏–∫', fontweight='bold')
    
    plt.tight_layout()
    plt.savefig('test_analysis.png', dpi=300, bbox_inches='tight')
    print("‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ test_analysis.png")
    plt.show()

# ============================================
# –û–¢–ß–Å–¢
# ============================================

def create_report(results_df, question_stats_df, topic_stats):
    """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ—Ç—á—ë—Ç–∞"""
    
    report_filename = 'test_report.txt'
    
    with open(report_filename, 'w', encoding='utf-8') as f:
        f.write("=" * 80 + "\n")
        f.write("–ê–ù–ê–õ–ò–¢–ò–ß–ï–°–ö–ò–ô –û–¢–ß–Å–¢ –ü–û –†–ï–ó–£–õ–¨–¢–ê–¢–ê–ú –ö–û–ù–¢–†–û–õ–¨–ù–û–ô –†–ê–ë–û–¢–´\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%d.%m.%Y %H:%M')}\n")
        f.write("=" * 80 + "\n\n")
        
        # –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        f.write("1. –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê\n")
        f.write("-" * 80 + "\n")
        f.write(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–Ω–∏–∫–æ–≤: {len(results_df)}\n")
        f.write(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π: {len([col for col in results_df.columns if col.startswith('–ó–∞–¥–∞–Ω–∏–µ_')])}\n")
        f.write(f"–°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–ª–∞—Å—Å–∞: {results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'].mean():.1f}%\n")
        f.write(f"–ú–µ–¥–∏–∞–Ω–∞: {results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'].median():.1f}%\n")
        f.write(f"–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'].max():.1f}%\n")
        f.write(f"–•—É–¥—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'].min():.1f}%\n\n")
        
        # –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –æ—Ü–µ–Ω–∫–∞–º
        excellent = len(results_df[results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'] >= 85])
        good = len(results_df[(results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'] >= 70) & (results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'] < 85)])
        satisfactory = len(results_df[(results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'] >= 50) & (results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'] < 70)])
        fail = len(results_df[results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'] < 50])
        
        f.write("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:\n")
        f.write(f"  –û—Ç–ª–∏—á–Ω–æ (‚â•85%): {excellent} —á–µ–ª. ({excellent/len(results_df)*100:.0f}%)\n")
        f.write(f"  –•–æ—Ä–æ—à–æ (70-84%): {good} —á–µ–ª. ({good/len(results_df)*100:.0f}%)\n")
        f.write(f"  –£–¥–æ–≤–ª. (50-69%): {satisfactory} —á–µ–ª. ({satisfactory/len(results_df)*100:.0f}%)\n")
        f.write(f"  –ù–µ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å (<50%): {fail} —á–µ–ª. ({fail/len(results_df)*100:.0f}%)\n\n")
        
        # –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
        f.write("2. –ü–†–û–ë–õ–ï–ú–ù–´–ï –ó–ê–î–ê–ù–ò–Ø (—É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å < 60%)\n")
        f.write("-" * 80 + "\n")
        problem_questions = question_stats_df[question_stats_df['–ü—Ä–æ—Ü–µ–Ω—Ç_–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö'] < 60]
        if len(problem_questions) > 0:
            for _, row in problem_questions.iterrows():
                f.write(f"\n{row['–ó–∞–¥–∞–Ω–∏–µ']}:\n")
                f.write(f"  –¢–µ–º–∞: {row['–¢–µ–º–∞']}\n")
                f.write(f"  –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª–∏: {row['–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö_–æ—Ç–≤–µ—Ç–æ–≤']}/{row['–í—Å–µ–≥–æ_—É—á–µ–Ω–∏–∫–æ–≤']} ({row['–ü—Ä–æ—Ü–µ–Ω—Ç_–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö']:.0f}%)\n")
                f.write(f"  –°–ª–æ–∂–Ω–æ—Å—Ç—å: {row['–°–ª–æ–∂–Ω–æ—Å—Ç—å']}\n")
        else:
            f.write("–ù–µ—Ç –∑–∞–¥–∞–Ω–∏–π —Å —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å—é –Ω–∏–∂–µ 60%\n")
        
        # –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ç–µ–º—ã
        f.write("\n3. –ê–ù–ê–õ–ò–ó –¢–ï–ú\n")
        f.write("-" * 80 + "\n")
        problem_topics = topic_stats[topic_stats['–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Ü–µ–Ω—Ç'] < 60]
        if len(problem_topics) > 0:
            f.write("–¢–µ–º—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∏:\n\n")
            for _, row in problem_topics.iterrows():
                f.write(f"  {row['–¢–µ–º–∞']}: {row['–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Ü–µ–Ω—Ç']:.0f}%\n")
        else:
            f.write("–í—Å–µ —Ç–µ–º—ã —É—Å–≤–æ–µ–Ω—ã –Ω–∞ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ\n")
        
        # –£—á–µ–Ω–∏–∫–∏, –Ω—É–∂–¥–∞—é—â–∏–µ—Å—è –≤ –ø–æ–º–æ—â–∏
        f.write("\n4. –£–ß–ï–ù–ò–ö–ò, –ù–£–ñ–î–ê–Æ–©–ò–ï–°–Ø –í –ü–û–ú–û–©–ò (—Ä–µ–∑—É–ª—å—Ç–∞—Ç < 50%)\n")
        f.write("-" * 80 + "\n")
        struggling = results_df[results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'] < 50][['–£—á–µ–Ω–∏–∫', '–û–±—â–∏–π_–±–∞–ª–ª', '–ü—Ä–æ—Ü–µ–Ω—Ç']]
        if len(struggling) > 0:
            for _, row in struggling.iterrows():
                f.write(f"  {row['–£—á–µ–Ω–∏–∫']}: {row['–û–±—â–∏–π_–±–∞–ª–ª']} –±–∞–ª–ª–æ–≤ ({row['–ü—Ä–æ—Ü–µ–Ω—Ç']:.1f}%)\n")
        else:
            f.write("–í—Å–µ —É—á–µ–Ω–∏–∫–∏ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å —Å —Ä–∞–±–æ—Ç–æ–π\n")
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        f.write("\n5. –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò\n")
        f.write("-" * 80 + "\n")
        
        if len(problem_topics) > 0:
            f.write("üìö –ü—Ä–æ–≤–µ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è –ø–æ —Ç–µ–º–∞–º:\n")
            for _, row in problem_topics.iterrows():
                f.write(f"   - {row['–¢–µ–º–∞']}\n")
        
        if len(struggling) > 0:
            f.write(f"\nüë• –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –¥–ª—è {len(struggling)} —É—á–µ–Ω–∏–∫–æ–≤\n")
        
        if results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'].mean() < 60:
            f.write("\n‚ö†Ô∏è  –°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–ª–∞—Å—Å–∞ –Ω–∏–∂–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:\n")
            f.write("   - –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –º–µ—Ç–æ–¥–∏–∫—É –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏—è\n")
            f.write("   - –£–¥–µ–ª–∏—Ç—å –±–æ–ª—å—à–µ –≤–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –∑–∞–¥–∞–Ω–∏—è–º\n")
            f.write("   - –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –æ—à–∏–±–∫–∞–º–∏\n")
        
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–æ–Ω–µ—Ü –æ—Ç—á—ë—Ç–∞\n")
        f.write("=" * 80 + "\n")
    
    print(f"‚úÖ –û—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ {report_filename}")

# ============================================
# –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø
# ============================================

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    
    print("\n" + "=" * 80)
    print("–°–ò–°–¢–ï–ú–ê –ê–ù–ê–õ–ò–ó–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø")
    print("=" * 80 + "\n")
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    print("üìä –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö...")
    results_df, test_info_df = generate_test_data()
    
    # –ê–Ω–∞–ª–∏–∑
    print("üîç –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...")
    results_df, question_stats_df, topic_stats = analyze_test_results(results_df, test_info_df)
    
    # –í—ã–≤–æ–¥ –∫—Ä–∞—Ç–∫–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    print(f"\n‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω!")
    print(f"   –°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'].mean():.1f}%")
    print(f"   –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'].max():.1f}%")
    print(f"   –•—É–¥—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {results_df['–ü—Ä–æ—Ü–µ–Ω—Ç'].min():.1f}%")
    
    # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
    print("\nüìà –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π...")
    create_analysis_dashboard(results_df, question_stats_df, topic_stats)
    
    # –û—Ç—á—ë—Ç
    print("üìù –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞...")
    create_report(results_df, question_stats_df, topic_stats)
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Excel
    print("üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Excel...")
    with pd.ExcelWriter('test_analysis.xlsx') as writer:
        results_df.to_excel(writer, sheet_name='–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—á–µ–Ω–∏–∫–æ–≤', index=False)
        question_stats_df.to_excel(writer, sheet_name='–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∑–∞–¥–∞–Ω–∏—è–º', index=False)
        topic_stats.to_excel(writer, sheet_name='–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–µ–º–∞–º', index=False)
    
    print("‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ test_analysis.xlsx")
    print("\n" + "=" * 80)
    print("–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω! –í—Å–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã.")
    print("=" * 80 + "\n")

if __name__ == "__main__":
    main()
```

---

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –ë–∞–ª–ª—ã |
|----------|-------|
| –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö | 10 |
| –ê–Ω–∞–ª–∏–∑ –ø–æ –∑–∞–¥–∞–Ω–∏—è–º | 15 |
| –ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–µ–º–∞–º | 15 |
| –í—ã—è–≤–ª–µ–Ω–∏–µ —É—á–µ–Ω–∏–∫–æ–≤ –≥—Ä—É–ø–ø—ã —Ä–∏—Å–∫–∞ | 10 |
| –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (–¥–∞—à–±–æ—Ä–¥) | 20 |
| –¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ | 15 |
| –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Excel | 10 |
| –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ | 5 |
| **–ò—Ç–æ–≥–æ** | **100** |

–£–¥–∞—á–∏! üìä

